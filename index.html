<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AzerothCore Download</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
  <!-- 引入语言文件 -->
  <script src="js/lang.js"></script>

  <style>
    /* 卡片hover上浮效果 */
    .hover-lift {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .hover-lift:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
    }
    /* 弹窗过渡动画 */
    .fade-in {
      animation: fadeIn 0.3s ease-in-out;
    }
    .scale-in {
      animation: scaleIn 0.3s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes scaleIn {
      from { transform: scale(0.95); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .backdrop-blur {
        backdrop-filter: blur(8px);
      }
    }

    /* 基础样式 */
    body {
      @apply bg-gray-50 font-sans text-gray-800;
    }

    /* 导航栏样式 */
    #navbar {
      @apply sticky top-0 z-50 bg-white shadow-md transition-all duration-300;
    }

    /* 移动端菜单样式 */
    #mobile-menu {
      @apply md:hidden hidden;
    }

    /* Banner区域样式（渐变纯色背景） */
    .wotlk-banner-bg {
      background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
      color: white;
      padding: 4rem 0;
      width: 100%;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    /* 下载区域样式 */
    #downloads {
      @apply py-16 bg-gray-50;
    }

    /* 统计图表区域 */
    #stats {
      @apply py-12 bg-white;
    }

    /* 地图下载模态框样式 */
    #map-modal {
      @apply fixed inset-0 z-50 flex items-center justify-center hidden;
    }

    /* 模态框内容样式 */
    #map-modal .relative {
      @apply bg-white rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-y-auto scale-in mx-4;
    }

    /* 图表区域样式 */
    #downloadsChart {
      @apply h-64;
    }

    /* 仓库统计样式 */
    .repo-stats {
      @apply py-16 bg-gradient-to-r from-blue-50 to-indigo-50;
    }
    
    .stat-card {
      @apply bg-white rounded-2xl shadow-md p-8 text-center hover-lift border border-gray-100;
    }

    /* 统计数据加载动画 */
    .stat-number {
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    .stat-number.loaded {
      opacity: 1;
      transform: translateY(0);
    }

    /* FAQ 区域样式 */
    .faq-toggle {
      @apply w-full text-left px-6 py-4 flex justify-between items-center focus:outline-none;
    }

    .faq-content {
      @apply px-6 pb-4 hidden;
    }

    /* 页脚样式 */
    footer {
      @apply bg-gray-900 text-white py-10;
    }

    footer .border-t {
      @apply border-gray-700 mt-12 pt-8 text-center text-gray-500;
    }

    /* 新增：模态框标题背景 */
    .gradient-bg {
      background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
    }

    /* 下载计数动画 */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    .download-count {
      transition: all 0.3s ease;
    }
    .download-count.pulse {
      animation: pulse 0.5s ease;
      color: #2563eb;
      font-weight: bold;
    }
    
    .build-status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: #374151;
    }

    .build-icon {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
    }

    .build-success {
      background-color: #10b981; /* 绿色 - 成功 */
    }

    .build-failure {
      background-color: #ef4444; /* 红色 - 失败 */
    }

    .build-running {
      background-color: #f59e0b; /* 橙色 - 运行中 */
      animation: spin 1.5s linear infinite;
    }

    .build-pending {
      background-color: #6b7280; /* 灰色 - 等待中 */
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
  
  <!-- Tailwind Configuration -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#2563eb',
            secondary: '#1e40af',
            dark: '#1e293b',
            light: '#f8fafc',
            accent: '#3b82f6',
            alternative: '#10b981' // 备用加速按钮颜色
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            mono: ['Fira Code', 'monospace']
          }
        }
      }
    }
  </script>
</head>

<body class="bg-gray-50 font-sans text-gray-800">
  <!-- Navigation Bar -->
  <header class="sticky top-0 z-50 bg-white shadow-md transition-all duration-300" id="navbar">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center py-4">
        <div class="flex items-center space-x-2">
          <i class="fa fa-github text-2xl text-gray-800"></i>
          <span class="text-xl font-bold text-primary">AzerothCore</span>
        </div>
        
        <nav class="hidden md:flex space-x-8">
          <a href="#" class="text-primary font-medium hover:text-secondary transition-colors" data-i18n="download"></a>
          <a href="javascript:;" title="Coming Soon" class="text-gray-600 cursor-not-allowed hover:text-gray-400 transition-colors" data-i18n="docs"></a>
          <a href="https://github.com/azerothcore/azerothcore-wotlk" target="_blank" class="text-gray-600 hover:text-primary transition-colors" data-i18n="github"></a>
          <a href="javascript:;" title="Coming Soon" class="text-gray-600 cursor-not-allowed hover:text-gray-400 transition-colors" data-i18n="support"></a>
        </nav>
        
        <div class="flex items-center space-x-4">
          <!-- Desktop Language Toggle -->
          <div class="hidden md:flex items-center border rounded-md overflow-hidden">
            <button id="lang-en-btn" class="px-3 py-2 text-sm font-medium text-primary bg-white hover:bg-blue-50 transition-colors">EN</button>
            <button id="lang-zh-btn" class="px-3 py-2 text-sm font-medium text-gray-600 bg-white hover:bg-blue-50 transition-colors">中文</button>
          </div>
          
          <button class="md:hidden text-gray-600 hover:text-primary" id="mobile-menu-button" aria-label="Toggle menu">
            <i class="fa fa-bars text-xl"></i>
          </button>
        </div>
      </div>
      
      <!-- Mobile Menu -->
      <div class="md:hidden hidden" id="mobile-menu">
        <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
          <!-- Mobile Language Toggle -->
          <div class="flex items-center justify-between p-3 border-b border-gray-100">
            <span class="text-sm font-medium text-gray-500" data-i18n="language"></span>
            <div class="flex border rounded-md overflow-hidden">
              <button id="mobile-lang-en-btn" class="px-3 py-1 text-sm font-medium text-primary bg-white">EN</button>
              <button id="mobile-lang-zh-btn" class="px-3 py-1 text-sm font-medium text-gray-600 bg-white">中文</button>
            </div>
          </div>
          
          <a href="#" class="block px-3 py-2 rounded-md text-base font-medium text-primary bg-blue-50" data-i18n="download"></a>
          <a href="javascript:;" title="Coming Soon" class="block px-3 py-2 rounded-md text-base font-medium text-gray-600 cursor-not-allowed hover:bg-gray-50" data-i18n="docs"></a>
          <a href="https://github.com/game760/ACore" target="_blank" class="block px-3 py-2 rounded-md text-base font-medium text-gray-600 hover:text-primary hover:bg-blue-50" data-i18n="github"></a>
          <a href="javascript:;" title="Coming Soon" class="block px-3 py-2 rounded-md text-base font-medium text-gray-600 cursor-not-allowed hover:bg-gray-50" data-i18n="support"></a>
        </div>
      </div>
    </div>
  </header>

  <!-- Banner区域（渐变纯色背景） -->
  <section class="wotlk-banner-bg text-white py-16 md:py-24">
    <!-- 装饰元素 -->
    <div class="absolute top-20 left-10 md:left-20 w-32 h-32 md:w-48 md:h-48 rounded-full bg-white/10 blur-2xl"></div>
    <div class="absolute bottom-20 right-10 md:right-20 w-24 h-24 md:w-36 md:h-36 rounded-full bg-white/10 blur-2xl"></div>
    
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
      <div class="max-w-3xl mx-auto text-center">
        <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4" data-i18n="bannerTitle"></h1>
        <p class="text-lg md:text-xl text-white/90 mb-8 max-w-2xl mx-auto" data-i18n="bannerDesc"></p>
        <a href="#downloads" class="inline-flex items-center px-8 py-3.5 bg-white text-primary rounded-lg font-semibold hover:bg-gray-100 transition-all shadow-lg hover:shadow-xl">
          <span data-i18n="getStarted"></span>
          <i class="fa fa-arrow-down ml-2"></i>
        </a>
      </div>
    </div>
  </section>

  <!-- 仓库统计区域（优化版） -->
  <section class="repo-stats py-16 bg-gradient-to-r from-blue-50 to-indigo-50">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-800 mb-4" data-i18n="repoStats"></h2>
        <p class="text-gray-600 max-w-2xl mx-auto text-lg" data-i18n="repoStatsDesc"></p>
      </div>
      
      <!-- 统计卡片容器：使用grid确保对齐，增加间距提升呼吸感 -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 max-w-5xl mx-auto">
        <!-- Stars 统计卡片（优化样式+对齐） -->
        <div class="stat-card flex flex-col items-center justify-between">
          <div class="text-center mb-6">
            <div class="flex items-center justify-center h-20 w-20 rounded-full bg-yellow-100 text-yellow-500 mb-4 mx-auto">
              <i class="fa fa-star text-3xl"></i>
            </div>
            <h3 class="text-lg font-semibold text-gray-700" data-i18n="stars"></h3>
          </div>
          <p class="text-4xl font-bold text-gray-800 stat-number" id="stars-count">
            <i class="fa fa-spinner fa-spin text-gray-400"></i>
          </p>
        </div>
        
        <!-- Forks 统计卡片 -->
        <div class="stat-card flex flex-col items-center justify-between">
          <div class="text-center mb-6">
            <div class="flex items-center justify-center h-20 w-20 rounded-full bg-green-100 text-green-500 mb-4 mx-auto">
              <i class="fa fa-code-fork text-3xl"></i>
            </div>
            <h3 class="text-lg font-semibold text-gray-700" data-i18n="forks"></h3>
          </div>
          <p class="text-4xl font-bold text-gray-800 stat-number" id="forks-count">
            <i class="fa fa-spinner fa-spin text-gray-400"></i>
          </p>
        </div>
        
        <!-- Issues 统计卡片 -->
        <div class="stat-card flex flex-col items-center justify-between">
          <div class="text-center mb-6">
            <div class="flex items-center justify-center h-20 w-20 rounded-full bg-red-100 text-red-500 mb-4 mx-auto">
              <i class="fa fa-exclamation-triangle text-3xl"></i>
            </div>
            <h3 class="text-lg font-semibold text-gray-700" data-i18n="openIssues"></h3>
          </div>
          <p class="text-4xl font-bold text-gray-800 stat-number" id="issues-count">
            <i class="fa fa-spinner fa-spin text-gray-400"></i>
          </p>
        </div>
        
        <!-- Contributors 统计卡片 -->
        <div class="stat-card flex flex-col items-center justify-between">
          <div class="text-center mb-6">
            <div class="flex items-center justify-center h-20 w-20 rounded-full bg-purple-100 text-purple-500 mb-4 mx-auto">
              <i class="fa fa-users text-3xl"></i>
            </div>
            <h3 class="text-lg font-semibold text-gray-700" data-i18n="contributors"></h3>
          </div>
          <p class="text-4xl font-bold text-gray-800 stat-number" id="contributors-count">
            <i class="fa fa-spinner fa-spin text-gray-400"></i>
          </p>
        </div>
      </div>
      
      <!-- GitHub跳转按钮（优化位置和样式） -->
      <div class="text-center mt-12">
        <a href="https://github.com/azerothcore/azerothcore-wotlk" target="_blank" 
           class="inline-flex items-center px-6 py-3 bg-primary text-white rounded-lg font-medium hover:bg-secondary transition-all shadow-md hover:shadow-lg">
          <i class="fa fa-github mr-2 text-xl"></i>
          <span data-i18n="viewOnGithub"></span>
        </a>
      </div>
    </div>
  </section>

  <!-- Download Section (4 Columns) -->
  <section id="downloads" class="py-16 bg-gray-50">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold mb-4" data-i18n="downloads"></h2>
      </div>
      
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 max-w-6xl mx-auto">
  
        <!-- Windows Download -->
        <div class="bg-white rounded-xl shadow-md overflow-hidden hover-lift">
          <div class="p-6">
            <div class="flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 text-primary mb-4 mx-auto">
              <i class="fa fa-windows text-2xl"></i>
            </div>
            <h3 class="text-xl font-semibold text-center mb-2">Windows</h3>
            <p class="text-gray-600 text-center mb-6">x64</p>
            <!-- 全球加速按钮 -->
            <a href="https://github.com/game760/acore/releases/download/Playerbots_Win_X64/playerbots_Win_x64.zip" target="_blank" 
               class="download-btn block w-full py-3 px-4 bg-primary text-white rounded-lg text-center font-medium hover:bg-secondary transition-colors mb-3"
               data-type="windows">
              <i class="fa fa-download mr-2"></i> 
              <span data-i18n="global"></span>
            </a>
            <!-- 备用加速按钮 -->
            <a href="https://gh-proxy.com/https://github.com/game760/acore/releases/download/Playerbots_Win_X64/playerbots_Win_x64.zip" target="_blank"
               class="download-btn block w-full py-3 px-4 bg-alternative text-white rounded-lg text-center font-medium hover:bg-green-600 transition-colors"
               data-type="windows">
              <i class="fa fa-download mr-2"></i> 
              <span data-i18n="alternative"></span>
            </a>
            <div class="mt-4 text-center text-sm text-gray-500">
              <span class="mr-4">
                <i class="fa fa-clock-o text-blue-500 mr-1"></i> 
                <span data-i18n="dailyBuild"></span>
              </span>
              <span>
                <i class="fa fa-download text-green-500 mr-1"></i> 
                <span class="download-count" data-type="windows">1233</span>
              </span>
            </div>
            <div class="flex items-center justify-center mt-4">
           <div class="build-status" data-repo="game760/acore" data-workflow="Win_X64.yml"></div>
           </div>
          </div>
        </div>
        
        <!-- Linux Download -->
        <div class="bg-white rounded-xl shadow-md overflow-hidden hover-lift">
          <div class="p-6">
            <div class="flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 text-primary mb-4 mx-auto">
              <i class="fa fa-linux text-2xl"></i>
            </div>
            <h3 class="text-xl font-semibold text-center mb-2">Linux</h3>
            <p class="text-gray-600 text-center mb-6">x64</p>
            <!-- 全球加速按钮 -->
            <a href="https://github.com/game760/acore/releases/download/Playerbots_Linux_x64/Playerbots_linux_x64.tar.gz" target="_blank"
               class="download-btn block w-full py-3 px-4 bg-primary text-white rounded-lg text-center font-medium hover:bg-secondary transition-colors mb-3"
               data-type="linux">
              <i class="fa fa-download mr-2"></i> 
              <span data-i18n="global"></span>
            </a>
            <!-- 备用加速按钮 -->
            <a href="https://gh-proxy.com/https://github.com/game760/acore/releases/download/Playerbots_Linux_x64/Playerbots_linux_x64.tar.gz" target="_blank"
               class="download-btn block w-full py-3 px-4 bg-alternative text-white rounded-lg text-center font-medium hover:bg-green-600 transition-colors"
               data-type="linux">
              <i class="fa fa-download mr-2"></i> 
              <span data-i18n="alternative"></span>
            </a>
            <div class="mt-4 text-center text-sm text-gray-500">
              <span class="mr-4">
                <i class="fa fa-clock-o text-blue-500 mr-1"></i> 
                <span data-i18n="dailyBuild"></span>
              </span>
              <span>
                <i class="fa fa-download text-green-500 mr-1"></i> 
                <span class="download-count" data-type="linux">857</span>
              </span>
            </div>
            <div class="flex items-center justify-center mt-4">
               <div class="build-status" data-repo="game760/acore" data-workflow="Linux_x64.yml"></div>
            </div>
          </div>
        </div>

        <!-- Map Download -->
        <div class="bg-white rounded-xl shadow-md overflow-hidden hover-lift">
          <div class="p-6">
            <div class="flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 text-primary mb-4 mx-auto">
              <i class="fa fa-map text-2xl"></i>
            </div>
            <h3 class="text-xl font-semibold text-center mb-2" data-i18n="mapResources"></h3>
            <p class="text-gray-600 text-center mb-6" data-i18n="general"></p>
            <!-- 全球加速按钮 -->
            <button id="map-download-btn" class="download-btn block w-full py-3 px-4 bg-primary text-white rounded-lg text-center font-medium hover:bg-secondary transition-colors mb-3"
                    data-type="maps">
              <i class="fa fa-download mr-2"></i> 
              <span data-i18n="global"></span>
            </button>
            <!-- 备用加速按钮 -->
            <button id="map-download-alt-btn" class="download-btn block w-full py-3 px-4 bg-alternative text-white rounded-lg text-center font-medium hover:bg-green-600 transition-colors"
                    data-type="maps">
              <i class="fa fa-download mr-2"></i> 
              <span data-i18n="alternative"></span>
            </button>
            <div class="mt-4 text-center text-sm text-gray-500">
              <span class="mr-4">
                <i class="fa fa-check-circle text-green-500 mr-1"></i> 
                <span data-i18n="required"></span>
              </span>
              <span>
                <i class="fa fa-download text-green-500 mr-1"></i> 
                <span class="download-count" data-type="maps">1026</span>
              </span>
            </div>
            <div class="flex items-center justify-center mt-4">
                <div class="build-status" data-repo="game760/mapdata" data-workflow="MapData.yml"></div>
            </div>
          </div>
        </div>
    
        <!-- Database Download -->
        <div class="bg-white rounded-xl shadow-md overflow-hidden hover-lift">
          <div class="p-6">
            <div class="flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 text-primary mb-4 mx-auto">
              <i class="fa fa-database text-2xl"></i>
            </div>
            <h3 class="text-xl font-semibold text-center mb-2" data-i18n="database"></h3>
            <p class="text-gray-600 text-center mb-6" data-i18n="mysql"></p>
            <!-- 全球加速按钮 -->
            <a href="https://github.com/game760/ACore/releases/download/DataBase/DataBase.tar.gz" target="_blank"
               class="download-btn block w-full py-3 px-4 bg-primary text-white rounded-lg text-center font-medium hover:bg-secondary transition-colors mb-3"
               data-type="database">
              <i class="fa fa-download mr-2"></i> 
              <span data-i18n="global"></span>
            </a>
            <!-- 备用加速按钮 -->
            <a href="https://gh-proxy.com/https://github.com/game760/ACore/releases/download/DataBase/DataBase.tar.gz" target="_blank"
               class="download-btn block w-full py-3 px-4 bg-alternative text-white rounded-lg text-center font-medium hover:bg-green-600 transition-colors"
               data-type="database">
              <i class="fa fa-download mr-2"></i> 
              <span data-i18n="alternative"></span>
            </a>
            <div class="mt-4 text-center text-sm text-gray-500">
              <span class="mr-4">
                <i class="fa fa-check-circle text-green-500 mr-1"></i> 
                <span data-i18n="required"></span>
              </span>
              <span>
                <i class="fa fa-download text-green-500 mr-1"></i> 
                <span class="download-count" data-type="database">1352</span>
              </span>
            </div>
            <div class="flex items-center justify-center mt-4">
            <div class="build-status" data-repo="game760/acore" data-workflow="Database.yml"></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 新增的地区提示 -->
      <div class="mt-10 max-w-6xl mx-auto bg-blue-50 border border-blue-100 rounded-lg p-4 text-center">
        <p class="text-gray-700" data-i18n="regionTip"></p>
      </div>
    </div>
  </section>

  <!-- Download Statistics Section -->
  <section id="stats" class="py-12 bg-white">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-10">
        <h2 class="text-2xl md:text-3xl font-bold mb-2" data-i18n="downloadStats"></h2>
        <p class="text-gray-600" data-i18n="downloadStatsDesc"></p>
      </div>
      
      <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-md p-6">
        <canvas id="downloadsChart"></canvas>
      </div>
    </div>
  </section>

  <!-- Map Download Modal -->
  <div id="map-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
    <!-- Overlay -->
    <div class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur fade-in"></div>
    
    <!-- Modal Content -->
    <div class="relative bg-white rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-y-auto scale-in mx-4">
      <!-- 模态框内语言切换按钮 -->
      <div class="absolute top-5 right-14 flex border rounded-md overflow-hidden z-10">
        <button id="modal-lang-en-btn" class="px-3 py-1 text-sm font-medium text-primary bg-white">EN</button>
        <button id="modal-lang-zh-btn" class="px-3 py-1 text-sm font-medium text-gray-600 bg-white">中文</button>
      </div>
      
      <!-- Close Button -->
      <button id="close-modal" class="absolute top-5 right-5 text-gray-500 hover:text-gray-700 transition-colors z-10" aria-label="Close modal">
        <i class="fa fa-times text-xl"></i>
      </button>
      
      <!-- Modal Header -->
      <div class="gradient-bg p-8 md:p-10">
        <h3 class="text-2xl md:text-3xl font-bold text-black" data-i18n="mapResources"></h3>
        <p class="text-blue-100 mt-2">
          <span class="text-black" data-i18n="mapResourcesDesc"></span>
        </p>
      </div>
      
      <!-- Modal Body -->
      <div class="p-8 md:p-10">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          <!-- DBC -->
          <div class="border border-gray-200 rounded-xl p-6 hover-lift">
            <div class="flex items-center justify-center h-14 w-14 rounded-full bg-blue-50 text-primary mb-5 mx-auto">
              <i class="fa fa-file-code-o text-2xl"></i>
            </div>
            <h4 class="text-lg font-semibold text-center mb-3">dbc</h4>
            <p class="text-gray-600 text-center text-sm mb-3">
              <span>Database client files containing game data</span>
              <span class="hidden">包含游戏数据的数据库客户端文件</span>
            </p>
            <p class="text-gray-500 text-center text-xs mb-3">
              <i class="fa fa-download text-green-500 mr-1"></i> 
              <span class="download-count" data-type="dbc">782</span>
            </p>
            <!-- 全球加速按钮 -->
            <a href="https://github.com/game760/mapdata/releases/download/MapData/dbc.zip" target="_blank"
               class="download-btn block w-full py-2 px-3 bg-primary text-white rounded-lg text-center text-sm font-medium hover:bg-secondary transition-colors mb-2"
               data-type="dbc">
              <i class="fa fa-download mr-1"></i> 
              <span data-i18n="global"></span>
            </a>
            <!-- 备用加速按钮 -->
            <a href="https://gh-proxy.com/https://github.com/game760/mapdata/releases/download/MapData/dbc.zip" target="_blank"
               class="download-btn block w-full py-2 px-3 bg-alternative text-white rounded-lg text-center text-sm font-medium hover:bg-green-600 transition-colors"
               data-type="dbc">
              <i class="fa fa-download mr-1"></i> 
              <span data-i18n="alternative"></span>
            </a>
          </div>
          
          <!-- VMAP -->
          <div class="border border-gray-200 rounded-xl p-6 hover-lift">
            <div class="flex items-center justify-center h-14 w-14 rounded-full bg-blue-50 text-primary mb-5 mx-auto">
              <i class="fa fa-cubes text-2xl"></i>
            </div>
            <h4 class="text-lg font-semibold text-center mb-3">vmap</h4>
            <p class="text-gray-600 text-center text-sm mb-3">
              <span>Visibility maps for line of sight calculations</span>
              <span class="hidden">用于视线计算的可见性地图</span>
            </p>
            <p class="text-gray-500 text-center text-xs mb-3">
              <i class="fa fa-download text-green-500 mr-1"></i> 
              <span class="download-count" data-type="vmap">643</span>
            </p>
            <!-- 全球加速按钮 -->
            <a href="https://github.com/game760/mapdata/releases/download/MapData/vmaps.zip" target="_blank"
               class="download-btn block w-full py-2 px-3 bg-primary text-white rounded-lg text-center text-sm font-medium hover:bg-secondary transition-colors mb-2"
               data-type="vmap">
              <i class="fa fa-download mr-1"></i> 
              <span data-i18n="global"></span>
            </a>
            <!-- 备用加速按钮 -->
            <a href="https://gh-proxy.com/https://github.com/game760/mapdata/releases/download/MapData/vmaps.zip" target="_blank"
               class="download-btn block w-full py-2 px-3 bg-alternative text-white rounded-lg text-center text-sm font-medium hover:bg-green-600 transition-colors"
               data-type="vmap">
              <i class="fa fa-download mr-1"></i> 
              <span data-i18n="alternative"></span>
            </a>
          </div>
          
          <!-- MMAPS -->
          <div class="border border-gray-200 rounded-xl p-6 hover-lift">
            <div class="flex items-center justify-center h-14 w-14 rounded-full bg-blue-50 text-primary mb-5 mx-auto">
              <i class="fa fa-road text-2xl"></i>
            </div>
            <h4 class="text-lg font-semibold text-center mb-3">mmaps</h4>
            <p class="text-gray-600 text-center text-sm mb-3">
              <span>Movement maps for creature navigation</span>
              <span class="hidden">用于生物导航的移动地图</span>
            </p>
            <p class="text-gray-500 text-center text-xs mb-3">
              <i class="fa fa-download text-green-500 mr-1"></i> 
              <span class="download-count" data-type="mmaps">598</span>
            </p>
            <!-- 全球加速按钮 -->
            <a href="https://github.com/game760/mapdata/releases/download/MapData/mmaps.zip" target="_blank"
               class="download-btn block w-full py-2 px-3 bg-primary text-white rounded-lg text-center text-sm font-medium hover:bg-secondary transition-colors mb-2"
               data-type="mmaps">
              <i class="fa fa-download mr-1"></i> 
              <span data-i18n="global"></span>
            </a>
            <!-- 备用加速按钮 -->
            <a href="https://gh-proxy.com/https://github.com/game760/mapdata/releases/download/MapData/mmaps.zip" target="_blank"
               class="download-btn block w-full py-2 px-3 bg-alternative text-white rounded-lg text-center text-sm font-medium hover:bg-green-600 transition-colors"
               data-type="mmaps">
              <i class="fa fa-download mr-1"></i> 
              <span data-i18n="alternative"></span>
            </a>
          </div>
          
          <!-- Cameras -->
          <div class="border border-gray-200 rounded-xl p-6 hover-lift">
            <div class="flex items-center justify-center h-14 w-14 rounded-full bg-blue-50 text-primary mb-5 mx-auto">
              <i class="fa fa-video-camera text-2xl"></i>
            </div>
            <h4 class="text-lg font-semibold text-center mb-3">Cameras</h4>
            <p class="text-gray-600 text-center text-sm mb-3">
              <span>Camera position data for in-game views</span>
              <span class="hidden">用于游戏内视图的相机位置数据</span>
            </p>
            <p class="text-gray-500 text-center text-xs mb-3">
              <i class="fa fa-download text-green-500 mr-1"></i> 
              <span class="download-count" data-type="cameras">421</span>
            </p>
            <!-- 全球加速按钮 -->
            <a href="https://github.com/game760/mapdata/releases/download/MapData/Cameras.zip" target="_blank"
               class="download-btn block w-full py-2 px-3 bg-primary text-white rounded-lg text-center text-sm font-medium hover:bg-secondary transition-colors mb-2"
               data-type="cameras">
              <i class="fa fa-download mr-1"></i> 
              <span data-i18n="global"></span>
            </a>
            <!-- 备用加速按钮 -->
            <a href="https://gh-proxy.com/https://github.com/game760/mapdata/releases/download/MapData/Cameras.zip" target="_blank"
               class="download-btn block w-full py-2 px-3 bg-alternative text-white rounded-lg text-center text-sm font-medium hover:bg-green-600 transition-colors"
               data-type="cameras">
              <i class="fa fa-download mr-1"></i> 
              <span data-i18n="alternative"></span>
            </a>
          </div>
          
          <!-- Maps -->
          <div class="border border-gray-200 rounded-xl p-6 hover-lift">
            <div class="flex items-center justify-center h-14 w-14 rounded-full bg-blue-50 text-primary mb-5 mx-auto">
              <i class="fa fa-map-o text-2xl"></i>
            </div>
            <h4 class="text-lg font-semibold text-center mb-3">Maps</h4>
            <p class="text-gray-600 text-center text-sm mb-3">
              <span>Base map files for world geometry</span>
              <span class="hidden">用于世界几何的基础地图文件</span>
            </p>
            <p class="text-gray-500 text-center text-xs mb-3">
              <i class="fa fa-download text-green-500 mr-1"></i> 
              <span class="download-count" data-type="maps-base">812</span>
            </p>
            <!-- 全球加速按钮 -->
            <a href="https://github.com/game760/mapdata/releases/download/MapData/maps.zip" target="_blank"
               class="download-btn block w-full py-2 px-3 bg-primary text-white rounded-lg text-center text-sm font-medium hover:bg-secondary transition-colors mb-2"
               data-type="maps-base">
              <i class="fa fa-download mr-1"></i> 
              <span data-i18n="global"></span>
            </a>
            <!-- 备用加速按钮 -->
            <a href="https://gh-proxy.com/https://github.com/game760/mapdata/releases/download/MapData/maps.zip" target="_blank"
               class="download-btn block w-full py-2 px-3 bg-alternative text-white rounded-lg text-center text-sm font-medium hover:bg-green-600 transition-colors"
               data-type="maps-base">
              <i class="fa fa-download mr-1"></i> 
              <span data-i18n="alternative"></span>
            </a>
          </div>

          <!-- Runlib -->
          <div class="border border-gray-200 rounded-xl p-6 hover-lift">
            <div class="flex items-center justify-center h-14 w-14 rounded-full bg-blue-50 text-primary mb-5 mx-auto">
              <i class="fa fa-compress text-2xl"></i>
            </div>
            <h4 class="text-lg font-semibold text-center mb-3" data-i18n="runtimeLibrary"></h4>
            <p class="text-gray-600 text-center text-sm mb-3" data-i18n="runtimeDesc"></p>
            <p class="text-gray-500 text-center text-xs mb-3">
              <i class="fa fa-download text-green-500 mr-1"></i> 
              <span class="download-count" data-type="runlib">926</span>
            </p>
            <!-- 全球加速按钮 -->
            <a href="https://github.com/game760/acore/releases/download/Runlib/Runlib.zip" target="_blank"
               class="download-btn block w-full py-2 px-3 bg-primary text-white rounded-lg text-center text-sm font-medium hover:bg-secondary transition-colors mb-2"
               data-type="runlib">
              <i class="fa fa-download mr-1"></i> 
              <span data-i18n="global"></span>
            </a>
            <!-- 备用加速按钮 -->
            <a href="https://gh-proxy.com/https://github.com/game760/acore/releases/download/Runlib/Runlib.zip" target="_blank"
               class="download-btn block w-full py-2 px-3 bg-alternative text-white rounded-lg text-center text-sm font-medium hover:bg-green-600 transition-colors"
               data-type="runlib">
              <i class="fa fa-download mr-1"></i> 
              <span data-i18n="alternative"></span>
            </a>
          </div>
        </div>
        
        <!-- Installation Notes -->
        <div class="mt-10 bg-gray-50 rounded-xl p-6 border border-gray-200">
          <h4 class="font-semibold text-lg mb-3 flex items-center">
            <i class="fa fa-info-circle text-primary mr-2"></i>
            <span data-i18n="installationNotes"></span>
          </h4>
          <ul class="text-gray-600 space-y-2 text-sm">
            <li class="flex items-start">
              <i class="fa fa-check-circle text-green-500 mt-1 mr-2"></i>
              <span data-i18n="installStep1"></span>
            </li>
            <li class="flex items-start">
              <i class="fa fa-check-circle text-green-500 mt-1 mr-2"></i>
              <span data-i18n="installStep2"></span>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- FAQ Section -->
  <section class="py-16 bg-gray-50">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-4xl">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold mb-4" data-i18n="faqTitle"></h2>
        <p class="text-gray-600" data-i18n="faqDesc"></p>
      </div>
      
      <div class="space-y-4">
        <!-- FAQ Item 1 -->
        <div class="bg-white rounded-xl shadow-sm overflow-hidden">
          <button class="faq-toggle font-medium text-gray-800 hover:text-primary" data-target="faq1">
            <span data-i18n="faq1Question"></span>
            <i class="fa fa-chevron-down text-gray-500 transition-transform duration-300"></i>
          </button>
          <div id="faq1" class="faq-content">
            <p class="text-gray-600" data-i18n="faq1Answer" data-i18n-html="true"></p>
          </div>
        </div>
        
        <!-- FAQ Item 2 -->
        <div class="bg-white rounded-xl shadow-sm overflow-hidden">
          <button class="faq-toggle font-medium text-gray-800 hover:text-primary" data-target="faq2">
            <span data-i18n="faq2Question"></span>
            <i class="fa fa-chevron-down text-gray-500 transition-transform duration-300"></i>
          </button>
          <div id="faq2" class="faq-content">
            <p class="text-gray-600" data-i18n="faq2Answer"></p>
          </div>
        </div>
        
        <!-- FAQ Item 3 -->
        <div class="bg-white rounded-xl shadow-sm overflow-hidden">
          <button class="faq-toggle font-medium text-gray-800 hover:text-primary" data-target="faq3">
            <span data-i18n="faq3Question"></span>
            <i class="fa fa-chevron-down text-gray-500 transition-transform duration-300"></i>
          </button>
          <div id="faq3" class="faq-content">
            <p class="text-gray-600" data-i18n="faq3Answer" data-i18n-html="true"></p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer Section -->
  <footer class="bg-gray-900 text-white pt-16 pb-8">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-12">
        <div>
          <div class="flex items-center space-x-2 mb-6">
            <i class="fa fa-github text-2xl text-white"></i>
            <span class="text-xl font-bold text-white">game760</span>
          </div>
          <p class="text-gray-400 mb-6" data-i18n="footerDesc"></p>
          <div class="flex space-x-4">
            <a href="https://github.com/game760/acore" target="_blank" class="text-gray-400 hover:text-white transition-colors" aria-label="GitHub">
              <i class="fa fa-github text-xl"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition-colors" aria-label="Discord">
              <i class="fa fa-discord text-xl"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition-colors" aria-label="Email">
              <i class="fa fa-envelope text-xl"></i>
            </a>
          </div>
        </div>
        
        <div>
          <h3 class="text-lg font-semibold mb-4" data-i18n="resources"></h3>
          <ul class="space-y-3">
            <li><a href="https://www.azerothcore.org/wiki/installation" class="text-gray-400 hover:text-white transition-colors" data-i18n="documentation"></a></li>
            <li><a href="https://www.azerothcore.org/wiki/getting-started" class="text-gray-400 hover:text-white transition-colors" data-i18n="tutorials"></a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors" data-i18n="apiReference"></a></li>
            <li><a href="https://github.com/azerothcore/azerothcore-wotlk/discussions" class="text-gray-400 hover:text-white transition-colors" data-i18n="community"></a></li>
          </ul>
        </div>
        
        <div>
          <h3 class="text-lg font-semibold mb-4" data-i18n="project"></h3>
          <ul class="space-y-3">
            <li><a href="https://github.com/azerothcore/azerothcore-wotlk" target="_blank" class="text-gray-400 hover:text-white transition-colors" data-i18n="github"></a></li>
            <li><a href="https://github.com/azerothcore/azerothcore-wotlk/issues" class="text-gray-400 hover:text-white transition-colors" data-i18n="issues"></a></li>
          </ul>
        </div>
        
        <div>
          <h3 class="text-lg font-semibold mb-4" data-i18n="legal"></h3>
          <ul class="space-y-3">
            <li><a href="https://www.gnu.org/licenses/agpl-3.0.en.html" class="text-gray-400 hover:text-white transition-colors" data-i18n="license"></a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors" data-i18n="privacyPolicy"></a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors" data-i18n="termsOfService"></a></li>
          </ul>
        </div>
      </div>
      
      <div class="border-t border-gray-700 pt-8">
        <div class="flex flex-col md:flex-row justify-between items-center">
          <p class="text-gray-500 text-sm mb-4 md:mb-0" data-i18n="copyright"></p>
          <div class="flex space-x-6">
            <a href="#" class="text-gray-500 hover:text-gray-300 text-sm transition-colors" data-i18n="privacy"></a>
            <a href="#" class="text-gray-500 hover:text-gray-300 text-sm transition-colors" data-i18n="terms"></a>
            <a href="#" class="text-gray-500 hover:text-gray-300 text-sm transition-colors" data-i18n="cookies"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

<script>
  // 存储下载计数数据
  const downloadCounts = {
    windows: 1233,
    linux: 857,
    maps: 1026,
    database: 752,
    dbc: 782,
    vmap: 643,
    mmaps: 598,
    cameras: 421,
    "maps-base": 812,
    "runlib": 926
  };

  // 从环境变量获取GitHub Token（通过工作流注入）
  const githubToken = BUILD.GITHUB_TOKEN || null;

  // 下载提示函数
  function showDownloadNotice() {
    alert(translations[currentLang].downloadTip);
  }

  // 更新下载计数函数
  function updateDownloadCount(type) {
    // 增加计数
    downloadCounts[type]++;
    
    // 更新所有相同类型的计数器
    document.querySelectorAll(`.download-count[data-type="${type}"]`).forEach(element => {
      // 添加动画效果
      element.classList.add('pulse');
      
      // 更新数字
      element.textContent = downloadCounts[type];
      
      // 移除动画类以允许下次动画
      setTimeout(() => {
        element.classList.remove('pulse');
      }, 500);
    });
    
    // 更新图表
    updateDownloadChart();
  }

  // 更新下载图表
  function updateDownloadChart() {
    if (window.downloadsChart) {
      window.downloadsChart.data.datasets[0].data = [
        downloadCounts.windows,
        downloadCounts.linux,
        downloadCounts.maps,
        downloadCounts.database
      ];
      // 强制更新图表确保样式同步
      window.downloadsChart.update('none');
    }
  }

  // 更新图表语言
  function updateChartLanguage(lang) {
    if (window.downloadsChart) {
      window.downloadsChart.data.datasets[0].label = translations[lang].downloadLabel;
      window.downloadsChart.options.scales.y.title.text = translations[lang].downloadCount;
      window.downloadsChart.options.plugins.tooltip.callbacks.label = function(context) {
        const value = context.raw;
        return translations[lang].downloadTooltip.replace('%d', value);
      };
      window.downloadsChart.update();
    }
  }

  // 获取GitHub仓库统计信息（使用环境变量Token）
  async function fetchGitHubRepoStats() {
    const repo = 'azerothcore/azerothcore-wotlk';
    const apiUrl = `https://api.github.com/repos/${repo}`;

    try {
      const headers = {
        'Accept': 'application/vnd.github.v3+json'
      };
      
      // 仅在Token存在时添加授权头（避免未注入时的错误）
      if (githubToken && typeof githubToken === 'string' && githubToken.trim() !== '') {
        headers['Authorization'] = `token ${githubToken}`;
      }

      const response = await fetch(apiUrl, { headers });

      if (!response.ok) {
        // 403表示限流，使用默认数据兜底
        if (response.status === 403) {
          throw new Error('API rate limited, using default data');
        }
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      const data = await response.json();
      
      // 更新Stars和Forks计数，并添加加载动画
      const starsElement = document.getElementById('stars-count');
      starsElement.textContent = data.stargazers_count.toLocaleString();
      starsElement.classList.add('loaded');
      
      const forksElement = document.getElementById('forks-count');
      forksElement.textContent = data.forks_count.toLocaleString();
      forksElement.classList.add('loaded');
      
      const issuesElement = document.getElementById('issues-count');
      issuesElement.textContent = data.open_issues_count.toLocaleString();
      issuesElement.classList.add('loaded');
      
      // 获取贡献者数量
      const contributorsUrl = `https://api.github.com/repos/${repo}/contributors?per_page=1`;
      const contributorsResponse = await fetch(contributorsUrl, { headers });
      
      // 从响应头获取贡献者总数
      const linkHeader = contributorsResponse.headers.get('Link');
      const contributorsElement = document.getElementById('contributors-count');
      
      if (linkHeader) {
        const lastPageMatch = linkHeader.match(/page=(\d+)>; rel="last"/);
        if (lastPageMatch) {
          contributorsElement.textContent = lastPageMatch[1];
        } else {
          contributorsElement.textContent = '1+';
        }
      } else {
        // 如果没有Link头，说明只有一页贡献者
        const contributors = await contributorsResponse.json();
        contributorsElement.textContent = contributors.length.toString();
      }
      
      contributorsElement.classList.add('loaded');
    } catch (error) {
      console.error('Error fetching GitHub repo stats:', error);
      // 限流或失败时，使用默认数据兜底
      const statsConfig = [
        { id: 'stars-count', default: '4.5k' },
        { id: 'forks-count', default: '1.2k' },
        { id: 'issues-count', default: '89' },
        { id: 'contributors-count', default: '200+' }
      ];

      statsConfig.forEach(({ id, default: defaultValue }) => {
        const element = document.getElementById(id);
        element.textContent = defaultValue;
        element.classList.add('loaded');
      });
    }
  }

  // 同步语言按钮样式
  function syncLangBtnStyles(isZh) {
    // 桌面端按钮
    const enBtn = document.getElementById('lang-en-btn');
    const zhBtn = document.getElementById('lang-zh-btn');
    if (enBtn && zhBtn) {
      enBtn.className = isZh 
        ? 'px-3 py-2 text-sm font-medium text-gray-600 bg-white hover:bg-blue-50 transition-colors' 
        : 'px-3 py-2 text-sm font-medium text-primary bg-white hover:bg-blue-50 transition-colors';
      zhBtn.className = isZh 
        ? 'px-3 py-2 text-sm font-medium text-primary bg-white hover:bg-blue-50 transition-colors' 
        : 'px-3 py-2 text-sm font-medium text-gray-600 bg-white hover:bg-blue-50 transition-colors';
    }

    // 移动端按钮
    const mobileEnBtn = document.getElementById('mobile-lang-en-btn');
    const mobileZhBtn = document.getElementById('mobile-lang-zh-btn');
    if (mobileEnBtn && mobileZhBtn) {
      mobileEnBtn.className = isZh 
        ? 'px-3 py-1 text-sm font-medium text-gray-600 bg-white' 
        : 'px-3 py-1 text-sm font-medium text-primary bg-white';
      mobileZhBtn.className = isZh 
        ? 'px-3 py-1 text-sm font-medium text-primary bg-white' 
        : 'px-3 py-1 text-sm font-medium text-gray-600 bg-white';
    }

    // 模态框按钮
    const modalEnBtn = document.getElementById('modal-lang-en-btn');
    const modalZhBtn = document.getElementById('modal-lang-zh-btn');
    if (modalEnBtn && modalZhBtn) {
      modalEnBtn.className = isZh 
        ? 'px-3 py-1 text-sm font-medium text-gray-600 bg-white' 
        : 'px-3 py-1 text-sm font-medium text-primary bg-white';
      modalZhBtn.className = isZh 
        ? 'px-3 py-1 text-sm font-medium text-primary bg-white' 
        : 'px-3 py-1 text-sm font-medium text-gray-600 bg-white';
    }
  }

  // 移动端菜单控制
  function toggleMobileMenu() {
    const mobileMenu = document.getElementById('mobile-menu');
    mobileMenu.classList.toggle('hidden');
  }

  // 移动端菜单链接点击后关闭菜单
  function initMobileMenuLinks() {
    const mobileLinks = document.querySelectorAll('#mobile-menu a');
    mobileLinks.forEach(link => {
      link.addEventListener('click', () => {
        const mobileMenu = document.getElementById('mobile-menu');
        mobileMenu.classList.add('hidden'); // 点击链接后关闭菜单
      });
    });
  }

  // 地图弹窗控制
  function openMapModal() {
    const modal = document.getElementById('map-modal');
    modal.classList.remove('hidden');
    // 阻止页面滚动
    document.body.style.overflow = 'hidden';
  }

  function closeMapModal() {
    const modal = document.getElementById('map-modal');
    modal.classList.add('hidden');
    // 恢复页面滚动
    document.body.style.overflow = '';
  }

  // FAQ 切换控制
  function initFaqToggles() {
    const toggles = document.querySelectorAll('.faq-toggle');
    toggles.forEach(toggle => {
      toggle.addEventListener('click', () => {
        const targetId = toggle.getAttribute('data-target');
        const content = document.getElementById(targetId);
        const icon = toggle.querySelector('i');
        
        // 切换当前FAQ项
        content.classList.toggle('hidden');
        icon.classList.toggle('rotate-180');
      });
    });
  }

  // 平滑滚动
  function initSmoothScroll() {
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const targetId = this.getAttribute('href');
        if (targetId === '#') return;
        
        const targetElement = document.querySelector(targetId);
        if (targetElement) {
          targetElement.scrollIntoView({
            behavior: 'smooth'
          });
        }
      });
    });
  }

  // 初始化下载按钮事件
  function initDownloadButtons() {
    const downloadButtons = document.querySelectorAll('.download-btn');
    downloadButtons.forEach(button => {
      button.addEventListener('click', function(e) {
        // 获取下载类型
        const downloadType = this.getAttribute('data-type');
        
        // 如果是地图按钮，先打开弹窗
        if (downloadType === 'maps' && (this.id === 'map-download-btn' || this.id === 'map-download-alt-btn')) {
          e.preventDefault();
          openMapModal();
          return;
        }
        
        // 更新下载计数
        updateDownloadCount(downloadType);
        
        // 显示下载提示
        showDownloadNotice();
      });
    });
  }

  // 状态图标映射
  const statusIcons = {
    success: '✓',
    failure: '✗',
    in_progress: '⟳',
    pending: '…'
  };

  // 状态样式映射
  const statusClasses = {
    success: 'build-success',
    failure: 'build-failure',
    in_progress: 'build-running',
    pending: 'build-pending'
  };

  // 获取并更新构建状态（使用环境变量Token）
  async function updateBuildStatus(container) {
    const repo = container.dataset.repo;
    const workflow = container.dataset.workflow;

    try {
      // 显示加载状态
      container.innerHTML = `
        <div class="build-icon build-pending">…</div>
        <span>${translations[currentLang].loadingStatus}</span>
      `;
      
      // 构建请求头
      const headers = {
        'Accept': 'application/vnd.github.v3+json'
      };
      
      // 仅在Token存在时添加授权头
      if (githubToken && typeof githubToken === 'string' && githubToken.trim() !== '') {
        headers['Authorization'] = `token ${githubToken}`;
      }
      
      // 调用GitHub API获取最新工作流状态
      const response = await fetch(
        `https://api.github.com/repos/${repo}/actions/workflows/${workflow}/runs?per_page=1`,
        { headers }
      );
      
      if (!response.ok) {
        if (response.status === 403) {
          // 限流时显示默认状态
          container.innerHTML = `
            <div class="build-icon build-success">✓</div>
            <span>${translations[currentLang].buildStatusNormal}</span>
          `;
          return;
        }
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      
      const data = await response.json();
      const latestRun = data.workflow_runs[0];
      
      if (!latestRun) {
        container.innerHTML = `
          <div class="build-icon build-pending">?</div>
          <span>${translations[currentLang].noRecords}</span>
        `;
        return;
      }
      
      // 确定最终状态 (运行中优先于完成状态)
      const status = latestRun.status === 'in_progress' 
        ? 'in_progress' 
        : latestRun.conclusion || 'pending';
      
      // 更新UI显示
      container.innerHTML = `
        <div class="build-icon ${statusClasses[status]}">${statusIcons[status]}</div>
        <span>
          ${status === 'success' ? translations[currentLang].successful : 
            status === 'failure' ? translations[currentLang].failed : 
            status === 'in_progress' ? translations[currentLang].building : translations[currentLang].waiting}
        </span>
        <a href="https://github.com/${repo}/actions/workflows/${workflow}" 
           target="_blank" class="text-primary hover:underline text-xs">
          <i class="fa fa-github"></i> ${translations[currentLang].buildDetails}
        </a>
      `;
    } catch (error) {
      console.error('Failed to Get Build Status:', error);
      // 失败时显示默认成功状态
      container.innerHTML = `
        <div class="build-icon build-success">✓</div>
        <span>${translations[currentLang].buildStatusNormal}</span>
      `;
    }
  }

  // 初始化所有构建状态显示
  function initBuildStatusDisplays() {
    const containers = document.querySelectorAll('.build-status');
    
    // 初始加载状态
    containers.forEach(container => {
      updateBuildStatus(container);
    });
    
    // 每30秒自动更新一次状态
    setInterval(() => {
      containers.forEach(container => {
        updateBuildStatus(container);
      });
    }, 30000);
  }

  // 页面加载完成后初始化
  document.addEventListener('DOMContentLoaded', function() {
    // 初始化翻译
    initTranslations();
    
    // 加载GitHub仓库统计信息
    fetchGitHubRepoStats();
    
    // 初始化图表
    const ctx = document.getElementById('downloadsChart');
    if (ctx) {
      window.downloadsChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Windows', 'Linux', 'Maps', 'Database'],
          datasets: [{
            label: translations[currentLang].downloadLabel,
            data: [
              downloadCounts.windows,
              downloadCounts.linux,
              downloadCounts.maps,
              downloadCounts.database
            ],
            backgroundColor: [
              'rgba(37, 99, 235, 0.7)',
              'rgba(30, 64, 175, 0.7)',
              'rgba(59, 130, 246, 0.7)',
              'rgba(96, 165, 250, 0.7)'
            ],
            borderColor: [
              'rgba(37, 99, 235, 1)',
              'rgba(30, 64, 175, 1)',
              'rgba(59, 130, 246, 1)',
              'rgba(96, 165, 250, 1)'
            ],
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: translations[currentLang].downloadCount
              }
            }
          },
          plugins: {
            tooltip: {
              callbacks: {
                label: function(context) {
                  const value = context.raw;
                  return translations[currentLang].downloadTooltip.replace('%d', value);
                }
              }
            }
          }
        }
      });
    }

    // 初始化语言按钮事件
    document.getElementById('lang-en-btn')?.addEventListener('click', () => changeLanguage('en'));
    document.getElementById('lang-zh-btn')?.addEventListener('click', () => changeLanguage('zh'));
    document.getElementById('mobile-lang-en-btn')?.addEventListener('click', () => changeLanguage('en'));
    document.getElementById('mobile-lang-zh-btn')?.addEventListener('click', () => changeLanguage('zh'));
    document.getElementById('modal-lang-en-btn')?.addEventListener('click', () => changeLanguage('en'));
    document.getElementById('modal-lang-zh-btn')?.addEventListener('click', () => changeLanguage('zh'));

    // 初始化移动端菜单事件
    document.getElementById('mobile-menu-button')?.addEventListener('click', toggleMobileMenu);

    // 初始化移动端菜单链接事件
    initMobileMenuLinks();

    // 初始化地图弹窗事件
    document.getElementById('map-download-btn')?.addEventListener('click', openMapModal);
    document.getElementById('map-download-alt-btn')?.addEventListener('click', openMapModal);
    document.getElementById('close-modal')?.addEventListener('click', closeMapModal);
    // 点击遮罩关闭弹窗
    document.getElementById('map-modal')?.addEventListener('click', (e) => {
      if (e.target === document.getElementById('map-modal')) {
        closeMapModal();
      }
    });
    // ESC键关闭弹窗
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !document.getElementById('map-modal').classList.contains('hidden')) {
        closeMapModal();
      }
    });

    // 初始化导航栏滚动效果
    window.addEventListener('scroll', () => {
      const navbar = document.getElementById('navbar');
      if (window.scrollY > 10) {
        navbar.classList.add('py-2');
        navbar.classList.remove('py-4');
      } else {
        navbar.classList.add('py-4');
        navbar.classList.remove('py-2');
      }
    });

    // 初始化FAQ切换
    initFaqToggles();

    // 初始化平滑滚动
    initSmoothScroll();

    // 初始化下载按钮事件
    initDownloadButtons();

    // 初始化构建状态显示
    initBuildStatusDisplays();
  });
</script>
</body>
</html>